<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Circle Photo Frame</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0a1628 0%, #1a2744 50%, #0f2557 100%);
        min-height: 100vh;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
    }

    /* Animated background particles */
    .particle {
        position: fixed;
        background: rgba(100, 150, 255, 0.15);
        border-radius: 50%;
        animation: float 15s infinite;
        pointer-events: none;
    }

    @keyframes float {
        0%, 100% { transform: translate(0, 0) rotate(0deg); }
        33% { transform: translate(30px, -30px) rotate(120deg); }
        66% { transform: translate(-20px, 20px) rotate(240deg); }
    }

    h2 {
        color: white;
        font-size: 2.5em;
        margin-bottom: 30px;
        text-align: center;
        text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
        animation: fadeInDown 0.8s ease;
    }

    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .container {
        background: rgba(255, 255, 255, 0.95);
        padding: 40px;
        border-radius: 24px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        max-width: 500px;
        width: 100%;
        margin: 0 auto 40px;
        animation: fadeInUp 0.8s ease;
        position: relative;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .title {
        font-size: 1.3em;
        font-weight: bold;
        color: #333;
        margin-bottom: 20px;
        text-align: center;
    }

    .frame-box {
        width: 320px;
        height: 320px;
        margin: 20px auto;
        position: relative;
        border-radius: 50%;
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        padding: 8px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        transition: transform 0.3s ease;
    }

    .frame-box:hover {
        transform: scale(1.02);
    }

    .frame-inner {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: white;
        padding: 6px;
        position: relative;
    }

    .canvas-container {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        overflow: hidden;
        background: #f0f0f0;
        position: relative;
    }

    canvas {
        border-radius: 50%;
        cursor: grab;
        user-select: none;
    }

    canvas:active {
        cursor: grabbing;
    }

    .placeholder {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #999;
        font-size: 1.1em;
        text-align: center;
        pointer-events: none;
    }

    .controls {
        margin-top: 20px;
    }

    .control-group {
        margin-bottom: 15px;
        display: none;
    }

    .control-group.active {
        display: block;
    }

    .control-group label {
        display: block;
        margin-bottom: 8px;
        color: #555;
        font-weight: 600;
        font-size: 0.9em;
    }

    input[type="range"] {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: #ddd;
        outline: none;
        -webkit-appearance: none;
    }

    input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #667eea;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    input[type="range"]::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #667eea;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .button-group {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    button {
        padding: 12px 24px;
        font-size: 16px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        flex: 1;
    }

    button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    button:active {
        transform: translateY(0);
    }

    .upload-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .download-btn {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        display: none;
    }

    .download-btn.active {
        display: block;
    }

    .frame-selector {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 15px;
        flex-wrap: wrap;
    }

    .frame-option {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        border: 3px solid transparent;
        transition: all 0.3s ease;
    }

    .frame-option:hover {
        transform: scale(1.1);
    }

    .frame-option.selected {
        border-color: #667eea;
        box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
    }

    .frame-1 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .frame-2 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .frame-3 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .frame-4 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    .frame-5 { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); }

    .hint {
        text-align: center;
        color: #999;
        font-size: 0.85em;
        margin-top: 10px;
    }
</style>
</head>
<body>

<!-- Animated background particles -->
<script>
    for(let i = 0; i < 20; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        const size = Math.random() * 80 + 30;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 15 + 's';
        particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
        document.body.appendChild(particle);
    }
</script>

<h2>‚ú® EduHack-4 Photo Frame ‚ú®</h2>

<div class="container">
    <p class="title">Create Your Perfect Frame</p>

    <div class="frame-box" id="frameBox">
        <div class="frame-inner">
            <div class="canvas-container">
                <canvas id="canvas" width="290" height="290"></canvas>
                <div class="placeholder" id="placeholder">
                    üì∏<br>Upload a photo to begin
                </div>
            </div>
        </div>
    </div>

    <div class="frame-selector">
        <div class="frame-option frame-1 selected" onclick="changeFrame(1)"></div>
        <div class="frame-option frame-2" onclick="changeFrame(2)"></div>
        <div class="frame-option frame-3" onclick="changeFrame(3)"></div>
        <div class="frame-option frame-4" onclick="changeFrame(4)"></div>
        <div class="frame-option frame-5" onclick="changeFrame(5)"></div>
    </div>

    <div class="controls">
        <div class="control-group" id="controls">
            <label>üîç Zoom: <span id="zoomValue">100%</span></label>
            <input type="range" id="zoomSlider" min="50" max="200" value="100">
        </div>
    </div>

    <div class="button-group">
        <input type="file" id="upload" accept="image/*" style="display:none;">
        <button class="upload-btn" onclick="document.getElementById('upload').click()">
            üì§ Upload Photo
        </button>
    </div>

    <button class="download-btn" id="downloadBtn" onclick="downloadImage()">
        üíæ Download Framed Photo
    </button>

    <p class="hint" id="hint"></p>
</div>

<script>
const uploadInput = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const downloadBtn = document.getElementById("downloadBtn");
const placeholder = document.getElementById("placeholder");
const zoomSlider = document.getElementById("zoomSlider");
const zoomValue = document.getElementById("zoomValue");
const controlsDiv = document.getElementById("controls");
const hint = document.getElementById("hint");
const frameBox = document.getElementById("frameBox");

let uploadedImage = null;
let imageScale = 1;
let imageX = 0;
let imageY = 0;
let isDragging = false;
let lastMouseX = 0;
let lastMouseY = 0;

const frameGradients = {
    1: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
    2: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
    3: 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
    4: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
    5: 'linear-gradient(135deg, #30cfd0 0%, #330867 100%)'
};

function changeFrame(frameNum) {
    frameBox.style.background = frameGradients[frameNum];
    document.querySelectorAll('.frame-option').forEach(opt => opt.classList.remove('selected'));
    document.querySelector(`.frame-${frameNum}`).classList.add('selected');
}

uploadInput.addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const img = new Image();
    img.onload = function() {
        uploadedImage = img;
        imageScale = 1;
        imageX = 0;
        imageY = 0;
        zoomSlider.value = 100;
        
        drawImage();
        placeholder.style.display = 'none';
        controlsDiv.classList.add('active');
        downloadBtn.classList.add('active');
        hint.textContent = 'üí° Drag the photo to position it, use zoom slider to adjust size';
    };
    img.src = URL.createObjectURL(file);
});

zoomSlider.addEventListener("input", function() {
    imageScale = this.value / 100;
    zoomValue.textContent = this.value + '%';
    drawImage();
});

// Mouse drag functionality
canvas.addEventListener('mousedown', function(e) {
    if (!uploadedImage) return;
    isDragging = true;
    lastMouseX = e.offsetX;
    lastMouseY = e.offsetY;
});

canvas.addEventListener('mousemove', function(e) {
    if (!isDragging || !uploadedImage) return;
    
    const deltaX = e.offsetX - lastMouseX;
    const deltaY = e.offsetY - lastMouseY;
    
    imageX += deltaX;
    imageY += deltaY;
    
    lastMouseX = e.offsetX;
    lastMouseY = e.offsetY;
    
    drawImage();
});

canvas.addEventListener('mouseup', function() {
    isDragging = false;
});

canvas.addEventListener('mouseleave', function() {
    isDragging = false;
});

// Touch support for mobile
canvas.addEventListener('touchstart', function(e) {
    if (!uploadedImage) return;
    e.preventDefault();
    isDragging = true;
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    lastMouseX = touch.clientX - rect.left;
    lastMouseY = touch.clientY - rect.top;
});

canvas.addEventListener('touchmove', function(e) {
    if (!isDragging || !uploadedImage) return;
    e.preventDefault();
    
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    const touchX = touch.clientX - rect.left;
    const touchY = touch.clientY - rect.top;
    
    const deltaX = touchX - lastMouseX;
    const deltaY = touchY - lastMouseY;
    
    imageX += deltaX;
    imageY += deltaY;
    
    lastMouseX = touchX;
    lastMouseY = touchY;
    
    drawImage();
});

canvas.addEventListener('touchend', function() {
    isDragging = false;
});

function drawImage() {
    if (!uploadedImage) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    ctx.save();
    
    // Create circular clipping mask
    ctx.beginPath();
    ctx.arc(145, 145, 145, 0, Math.PI * 2);
    ctx.closePath();
    ctx.clip();

    // Calculate dimensions
    const size = Math.min(uploadedImage.width, uploadedImage.height);
    const scaledSize = canvas.width * imageScale;
    const offsetX = (canvas.width - scaledSize) / 2 + imageX;
    const offsetY = (canvas.height - scaledSize) / 2 + imageY;

    // Draw image
    ctx.drawImage(
        uploadedImage,
        (uploadedImage.width - size) / 2,
        (uploadedImage.height - size) / 2,
        size,
        size,
        offsetX,
        offsetY,
        scaledSize,
        scaledSize
    );

    ctx.restore();
}

function downloadImage() {
    if (!uploadedImage) return;

    // Create a temporary canvas for the final image with frame
    const finalCanvas = document.createElement('canvas');
    finalCanvas.width = 600;
    finalCanvas.height = 600;
    const finalCtx = finalCanvas.getContext('2d');

    // Draw white background
    finalCtx.fillStyle = 'white';
    finalCtx.fillRect(0, 0, 600, 600);

    // Draw frame gradient
    const gradient = finalCtx.createLinearGradient(0, 0, 600, 600);
    const currentFrame = document.querySelector('.frame-option.selected');
    const frameNum = currentFrame.className.match(/frame-(\d)/)[1];
    
    const gradients = {
        1: ['#f093fb', '#f5576c'],
        2: ['#4facfe', '#00f2fe'],
        3: ['#43e97b', '#38f9d7'],
        4: ['#fa709a', '#fee140'],
        5: ['#30cfd0', '#330867']
    };
    
    gradient.addColorStop(0, gradients[frameNum][0]);
    gradient.addColorStop(1, gradients[frameNum][1]);
    
    finalCtx.fillStyle = gradient;
    finalCtx.beginPath();
    finalCtx.arc(300, 300, 290, 0, Math.PI * 2);
    finalCtx.fill();

    // Draw white inner circle
    finalCtx.fillStyle = 'white';
    finalCtx.beginPath();
    finalCtx.arc(300, 300, 275, 0, Math.PI * 2);
    finalCtx.fill();

    // Draw the photo
    finalCtx.save();
    finalCtx.beginPath();
    finalCtx.arc(300, 300, 265, 0, Math.PI * 2);
    finalCtx.closePath();
    finalCtx.clip();

    const size = Math.min(uploadedImage.width, uploadedImage.height);
    const scaledSize = 530 * imageScale;
    const scale = 600 / 290; // Scaling factor from canvas to final image
    const offsetX = (600 - scaledSize) / 2 + (imageX * scale);
    const offsetY = (600 - scaledSize) / 2 + (imageY * scale);

    finalCtx.drawImage(
        uploadedImage,
        (uploadedImage.width - size) / 2,
        (uploadedImage.height - size) / 2,
        size,
        size,
        offsetX,
        offsetY,
        scaledSize,
        scaledSize
    );

    finalCtx.restore();

    // Download
    const link = document.createElement("a");
    link.download = "eduhack4-framed-photo.png";
    link.href = finalCanvas.toDataURL("image/png");
    link.click();
}
</script>

</body>
</html>