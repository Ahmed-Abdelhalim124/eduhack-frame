<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>EduHack-AI-4 - Attendee Frame</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Arial', sans-serif;
        background: #0a0e27;
        min-height: 100vh;
        padding: 20px;
        touch-action: pan-y;
        overflow-x: hidden;
    }

    .bg-pattern {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #0a0e27 0%, #1a1d3a 50%, #0f1229 100%);
        z-index: 0;
    }

    .particle {
        position: fixed;
        background: radial-gradient(circle, rgba(138, 43, 226, 0.2) 0%, transparent 70%);
        border-radius: 50%;
        animation: float 20s infinite;
        pointer-events: none;
    }

    @keyframes float {
        0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.3; }
        33% { transform: translate(50px, -50px) scale(1.2); opacity: 0.5; }
        66% { transform: translate(-30px, 30px) scale(0.8); opacity: 0.3; }
    }

    .header {
        background: #161b2b;
        backdrop-filter: blur(10px);
        padding: 15px 20px;
        box-shadow: 0 4px 30px rgba(138, 43, 226, 0.2);
        position: relative;
        z-index: 10;
        border-bottom: 2px solid rgba(138, 43, 226, 0.3);
        border-radius: 15px;
        margin-bottom: 30px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 15px;
    }

    .header-logo {
        width: 150px;
        height: 120px;
        object-fit: contain;
        flex-shrink: 0;
    }

    .header-content {
        text-align: center;
        flex: 1;
    }

    .header h1 {
        font-size: clamp(1.2em, 4vw, 2.2em);
        background: linear-gradient(135deg, #00d9ff, #ec4899);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 0;
    }

    .header p {
        color: rgba(255,255,255,0.9);
        margin-top: 5px;
        font-size: clamp(0.8em, 2.5vw, 1.1em);
    }

    .header-spacer {
        width: 80px;
        flex-shrink: 0;
    }

    .main-container {
        max-width: 1600px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr;
        gap: 30px;
        position: relative;
        z-index: 10;
    }

    .form-section {
        background: rgba(26, 29, 58, 0.8);
        backdrop-filter: blur(20px);
        padding: 25px;
        border-radius: 24px;
        box-shadow: 0 10px 40px rgba(138, 43, 226, 0.3);
        border: 1px solid rgba(138, 43, 226, 0.3);
    }

    .preview-section {
        background: rgba(26, 29, 58, 0.8);
        backdrop-filter: blur(20px);
        padding: 25px;
        border-radius: 24px;
        box-shadow: 0 10px 40px rgba(236, 72, 153, 0.3);
        border: 1px solid rgba(236, 72, 153, 0.3);
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        color: #00d9ff;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: clamp(0.8em, 2.5vw, 0.9em);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .form-group input, .form-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid rgba(138, 43, 226, 0.3);
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: rgba(10, 14, 39, 0.6);
        color: white;
    }

    .form-group input::placeholder {
        color: rgba(255, 255, 255, 0.4);
    }

    .form-group input:focus, .form-group select:focus {
        outline: none;
        border-color: #8a2be2;
        background: rgba(10, 14, 39, 0.9);
        box-shadow: 0 0 20px rgba(138, 43, 226, 0.3);
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }

    .upload-area {
        border: 3px dashed #8a2be2;
        border-radius: 15px;
        padding: 25px 15px;
        text-align: center;
        background: rgba(138, 43, 226, 0.1);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .upload-area:hover {
        background: rgba(138, 43, 226, 0.2);
        border-color: #ec4899;
        transform: translateY(-2px);
    }

    .upload-area p {
        color: #00d9ff;
        font-weight: 600;
        margin-bottom: 5px;
        font-size: clamp(0.85em, 2.5vw, 1.1em);
    }

    .section-title {
        color: #ec4899;
        font-size: clamp(1em, 3vw, 1.2em);
        font-weight: bold;
        margin: 25px 0 15px 0;
        padding-bottom: 10px;
        border-bottom: 2px solid rgba(236, 72, 153, 0.3);
    }

    .frame-preview {
        width: 100%;
        max-width: 100%;
        margin: 0 auto 20px;
        position: relative;
    }

    .badge-container {
        position: relative;
        width: 100%;
        padding-bottom: 59.38%;
        background: #1a1a1a;
        border-radius: 10px;
        overflow: hidden;
    }

    .frame-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 1;
        pointer-events: none;
    }

    .badge-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 5;
    }

    .photo-circle {
        position: absolute;
        width: 36%;
        height: 60.5%;
        top: 19.5%;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 50%;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10;
    }

    .photo-inner {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #1a1a1a;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .photo-canvas {
        border-radius: 50%;
        cursor: grab;
        width: 100%;
        height: 100%;
        touch-action: none;
    }

    .photo-canvas:active {
        cursor: grabbing;
    }

    .placeholder {
        color: #555;
        font-size: clamp(2em, 6vw, 3em);
        pointer-events: none;
    }

    .user-info-item {
        position: absolute;
        z-index: 15;
        cursor: move;
        background: rgba(138, 43, 226, 0.1);
        border: 2px dashed rgba(138, 43, 226, 0.5);
        border-radius: 8px;
        padding: 8px;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
        word-wrap: break-word;
        line-height: 1.2;
        font-weight: bold;
        font-family: Arial, sans-serif;
        text-align: left;
    }

    .user-info-item:hover {
        background: rgba(138, 43, 226, 0.2);
        border-color: #8a2be2;
        box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
    }

    .controls {
        margin-top: 20px;
        display: none;
    }

    .controls.active {
        display: block;
    }

    .controls label {
        display: block;
        color: #00d9ff;
        font-weight: 600;
        margin-bottom: 8px;
        font-size: clamp(0.85em, 2.5vw, 1em);
    }

    input[type="range"] {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: rgba(138, 43, 226, 0.3);
        outline: none;
        -webkit-appearance: none;
    }

    input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: linear-gradient(135deg, #8a2be2, #ec4899);
        cursor: pointer;
        box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
    }

    input[type="range"]::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: linear-gradient(135deg, #8a2be2, #ec4899);
        cursor: pointer;
        box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        border: none;
    }

    .action-buttons {
        display: none;
        flex-direction: column;
        gap: 12px;
        margin-top: 20px;
    }

    .action-buttons.active {
        display: flex;
    }

    .btn {
        padding: 14px 24px;
        border: none;
        border-radius: 12px;
        font-size: clamp(13px, 2.5vw, 16px);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        text-decoration: none;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(138, 43, 226, 0.4);
    }

    .btn-download {
        background: linear-gradient(135deg, #8a2be2, #ec4899);
        color: white;
    }

    .btn-linkedin {
        background: linear-gradient(135deg, #0077b5, #00a0dc);
        color: white;
    }

    .btn-copy {
        background: linear-gradient(135deg, #ec4899, #8a2be2);
        color: white;
    }

    .hint {
        text-align: center;
        color: rgba(255, 255, 255, 0.6);
        font-size: clamp(0.7em, 2vw, 0.85em);
        margin-top: 10px;
        font-style: italic;
    }

    .dimensions-output {
        background: rgba(0, 217, 255, 0.1);
        border: 2px solid rgba(0, 217, 255, 0.3);
        border-radius: 12px;
        padding: 15px;
        margin-top: 20px;
        color: #00d9ff;
        font-family: 'Courier New', monospace;
        font-size: clamp(0.75em, 2vw, 0.9em);
        line-height: 1.8;
    }

    .dimensions-output strong {
        color: #ec4899;
    }

    @media (min-width: 1024px) {
        .main-container {
            grid-template-columns: 1fr 1.2fr;
            gap: 40px;
        }

        .preview-section {
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .action-buttons {
            flex-direction: row;
        }

        .header-logo {
            width: 100px;
            height: 100px;
        }

        .header-spacer {
            width: 100px;
        }

        .header {
            padding: 20px;
        }
    }

    @media (max-width: 1023px) {
        body {
            padding: 10px;
        }

        .header {
            padding: 12px 15px;
            margin-bottom: 20px;
        }

        .form-section, .preview-section {
            padding: 20px;
        }

        .form-row {
            grid-template-columns: 1fr;
        }

        .section-title {
            margin: 20px 0 12px 0;
        }

        .dimensions-output {
            padding: 12px;
        }
    }

    @media (max-width: 480px) {
        body {
            padding: 8px;
        }

        .header {
            padding: 10px;
            gap: 10px;
        }

        .header-logo {
            width: 90px;
            height: 90px;
        }

        .header-spacer {
            width: 70px;
        }

        .form-section, .preview-section {
            padding: 15px;
            border-radius: 18px;
        }

        .upload-area {
            padding: 20px 10px;
        }

        .user-info-item {
            padding: 6px;
        }
    }
</style>
</head>
<body>

<div class="bg-pattern"></div>

<script>
    for(let i = 0; i < 15; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        const size = Math.random() * 150 + 50;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 20 + 's';
        particle.style.animationDuration = (Math.random() * 15 + 15) + 's';
        document.body.appendChild(particle);
    }
</script>

<div class="header">
    <img src="logo.png" alt="Sahaba Club Logo" class="header-logo">
    <div class="header-content">
        <h1>EduHack-AI-4 Attendee Frame Generator</h1>
        <p>Made by Sahaba Club</p>
    </div>
    <div class="header-spacer"></div>
</div>

<div class="main-container">
    <div class="form-section">
        <div class="section-title">üìù User Information</div>
        
        <div class="form-group">
            <label>FULL NAME</label>
            <input type="text" id="fullName" placeholder="Enter your full name">
        </div>

        <div class="form-group">
            <label>STUDENT OR WORKING</label>
            <input type="text" id="jobTitle" placeholder="e.g., Student, Software Engineer">
        </div>

        <div class="form-group">
            <label>COMPANY OR UNIVERSITY</label>
            <input type="text" id="company" placeholder="Enter your institution">
        </div>

        <div class="form-group">
            <label>PROFILE PHOTO</label>
            <div class="upload-area" onclick="document.getElementById('upload').click()">
                <p>üì∏ CLICK TO UPLOAD YOUR PHOTO</p>
                <small style="color: rgba(255,255,255,0.6); font-size: clamp(0.7em, 2vw, 0.9em);">Square format recommended</small>
            </div>
            <input type="file" id="upload" accept="image/*" style="display:none;">
        </div>

        <div class="section-title">üé® Name Positioning & Styling</div>

        <div class="form-row">
            <div class="form-group">
                <label>Top Position (%)</label>
                <input type="number" id="nameTop" value="31" min="0" max="100" step="0.5">
            </div>
            <div class="form-group">
                <label>Right Position (%)</label>
                <input type="number" id="nameRight" value="7" min="0" max="100" step="0.5">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Width (%)</label>
                <input type="number" id="nameWidth" value="24" min="10" max="50" step="0.5">
            </div>
            <div class="form-group">
                <label>Font Size (px)</label>
                <input type="number" id="nameFontSize" value="28" min="10" max="60" step="1">
            </div>
        </div>

        <div class="section-title">üíº Job Title Positioning & Styling</div>

        <div class="form-row">
            <div class="form-group">
                <label>Top Position (%)</label>
                <input type="number" id="jobTop" value="37" min="0" max="100" step="0.5">
            </div>
            <div class="form-group">
                <label>Right Position (%)</label>
                <input type="number" id="jobRight" value="7" min="0" max="100" step="0.5">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Width (%)</label>
                <input type="number" id="jobWidth" value="24" min="10" max="50" step="0.5">
            </div>
            <div class="form-group">
                <label>Font Size (px)</label>
                <input type="number" id="jobFontSize" value="22" min="10" max="50" step="1">
            </div>
        </div>

        <div class="section-title">üè¢ Company Positioning & Styling</div>

        <div class="form-row">
            <div class="form-group">
                <label>Top Position (%)</label>
                <input type="number" id="companyTop" value="43" min="0" max="100" step="0.5">
            </div>
            <div class="form-group">
                <label>Right Position (%)</label>
                <input type="number" id="companyRight" value="7" min="0" max="100" step="0.5">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Width (%)</label>
                <input type="number" id="companyWidth" value="24" min="10" max="50" step="0.5">
            </div>
            <div class="form-group">
                <label>Font Size (px)</label>
                <input type="number" id="companyFontSize" value="22" min="10" max="50" step="1">
            </div>
        </div>

        <div class="dimensions-output" id="dimensionsOutput">
            <strong>üìä Current Dimensions:</strong><br><br>
            <strong>Name:</strong><br>
            Top: <span id="dimNameTop">31</span>% | Right: <span id="dimNameRight">7</span>% | Width: <span id="dimNameWidth">24</span>% | Font: <span id="dimNameFont">28</span>px<br><br>
            <strong>Job Title:</strong><br>
            Top: <span id="dimJobTop">37</span>% | Right: <span id="dimJobRight">7</span>% | Width: <span id="dimJobWidth">24</span>% | Font: <span id="dimJobFont">22</span>px<br><br>
            <strong>Company:</strong><br>
            Top: <span id="dimCompanyTop">43</span>% | Right: <span id="dimCompanyRight">7</span>% | Width: <span id="dimCompanyWidth">24</span>% | Font: <span id="dimCompanyFont">22</span>px
        </div>

        <button class="btn btn-copy" id="copyDimensions" style="margin-top: 15px;">
            üìã Copy Dimensions
        </button>
    </div>

    <div class="preview-section">
        <div class="frame-preview">
            <div class="badge-container" id="badgeContainer">
                <img src="frame.jpg" alt="Badge Frame" class="frame-image">
                <div class="badge-content">
                    <div class="photo-circle">
                        <div class="photo-inner">
                            <canvas id="canvas" class="photo-canvas" width="400" height="400"></canvas>
                            <div class="placeholder" id="placeholder">üë§</div>
                        </div>
                    </div>
                    <div class="user-info-item" id="nameOverlay" style="top: 31%; right: 7%; width: 24%; font-size: 28px;">Your Name</div>
                    <div class="user-info-item" id="jobOverlay" style="top: 37%; right: 7%; width: 24%; font-size: 22px;">Student/Working</div>
                    <div class="user-info-item" id="companyOverlay" style="top: 43%; right: 7%; width: 24%; font-size: 22px;">Your Institution</div>
                </div>
            </div>
        </div>

        <div class="controls" id="controls">
            <label>üîç Zoom: <span id="zoomValue">100%</span></label>
            <input type="range" id="zoomSlider" min="50" max="300" value="100">
            <p class="hint">üí° Drag the photo to position it | Drag the text boxes to reposition</p>
        </div>

        <div class="action-buttons" id="actionButtons">
            <button class="btn btn-download" id="downloadBtn">
                üì• Download Badge
            </button>
            <button class="btn btn-linkedin" id="linkedinBtn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/>
                </svg>
                Share on LinkedIn
            </button>
        </div>
    </div>
</div>

<script>
const uploadInput = document.getElementById("upload");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const placeholder = document.getElementById("placeholder");
const zoomSlider = document.getElementById("zoomSlider");
const zoomValue = document.getElementById("zoomValue");
const controlsDiv = document.getElementById("controls");
const actionButtons = document.getElementById("actionButtons");
const downloadBtn = document.getElementById("downloadBtn");
const linkedinBtn = document.getElementById("linkedinBtn");
const copyDimensionsBtn = document.getElementById("copyDimensions");

const fullNameInput = document.getElementById("fullName");
const jobTitleInput = document.getElementById("jobTitle");
const companyInput = document.getElementById("company");
const nameOverlay = document.getElementById("nameOverlay");
const jobOverlay = document.getElementById("jobOverlay");
const companyOverlay = document.getElementById("companyOverlay");
const badgeContainer = document.getElementById("badgeContainer");

const nameTopInput = document.getElementById("nameTop");
const nameRightInput = document.getElementById("nameRight");
const nameWidthInput = document.getElementById("nameWidth");
const nameFontSizeInput = document.getElementById("nameFontSize");

const jobTopInput = document.getElementById("jobTop");
const jobRightInput = document.getElementById("jobRight");
const jobWidthInput = document.getElementById("jobWidth");
const jobFontSizeInput = document.getElementById("jobFontSize");

const companyTopInput = document.getElementById("companyTop");
const companyRightInput = document.getElementById("companyRight");
const companyWidthInput = document.getElementById("companyWidth");
const companyFontSizeInput = document.getElementById("companyFontSize");

let uploadedImage = null;
let imageScale = 1;
let imageX = 0;
let imageY = 0;
let isDragging = false;
let isDraggingName = false;
let isDraggingJob = false;
let isDraggingCompany = false;
let lastMouseX = 0;
let lastMouseY = 0;
let downloadedImageUrl = null;

fullNameInput.addEventListener("input", function() {
    nameOverlay.textContent = this.value || "Your Name";
});

jobTitleInput.addEventListener("input", function() {
    jobOverlay.textContent = this.value || "Student/Working";
});

companyInput.addEventListener("input", function() {
    companyOverlay.textContent = this.value || "Your Institution";
});

function updateNamePosition() {
    const top = nameTopInput.value;
    const right = nameRightInput.value;
    const width = nameWidthInput.value;
    const fontSize = nameFontSizeInput.value;

    nameOverlay.style.top = top + '%';
    nameOverlay.style.right = right + '%';
    nameOverlay.style.width = width + '%';
    nameOverlay.style.fontSize = fontSize + 'px';

    document.getElementById('dimNameTop').textContent = top;
    document.getElementById('dimNameRight').textContent = right;
    document.getElementById('dimNameWidth').textContent = width;
    document.getElementById('dimNameFont').textContent = fontSize;
}

function updateJobPosition() {
    const top = jobTopInput.value;
    const right = jobRightInput.value;
    const width = jobWidthInput.value;
    const fontSize = jobFontSizeInput.value;

    jobOverlay.style.top = top + '%';
    jobOverlay.style.right = right + '%';
    jobOverlay.style.width = width + '%';
    jobOverlay.style.fontSize = fontSize + 'px';

    document.getElementById('dimJobTop').textContent = top;
    document.getElementById('dimJobRight').textContent = right;
    document.getElementById('dimJobWidth').textContent = width;
    document.getElementById('dimJobFont').textContent = fontSize;
}

function updateCompanyPosition() {
    const top = companyTopInput.value;
    const right = companyRightInput.value;
    const width = companyWidthInput.value;
    const fontSize = companyFontSizeInput.value;

    companyOverlay.style.top = top + '%';
    companyOverlay.style.right = right + '%';
    companyOverlay.style.width = width + '%';
    companyOverlay.style.fontSize = fontSize + 'px';

    document.getElementById('dimCompanyTop').textContent = top;
    document.getElementById('dimCompanyRight').textContent = right;
    document.getElementById('dimCompanyWidth').textContent = width;
    document.getElementById('dimCompanyFont').textContent = fontSize;
}

nameTopInput.addEventListener("input", updateNamePosition);
nameRightInput.addEventListener("input", updateNamePosition);
nameWidthInput.addEventListener("input", updateNamePosition);
nameFontSizeInput.addEventListener("input", updateNamePosition);

jobTopInput.addEventListener("input", updateJobPosition);
jobRightInput.addEventListener("input", updateJobPosition);
jobWidthInput.addEventListener("input", updateJobPosition);
jobFontSizeInput.addEventListener("input", updateJobPosition);

companyTopInput.addEventListener("input", updateCompanyPosition);
companyRightInput.addEventListener("input", updateCompanyPosition);
companyWidthInput.addEventListener("input", updateCompanyPosition);
companyFontSizeInput.addEventListener("input", updateCompanyPosition);

updateNamePosition();
updateJobPosition();
updateCompanyPosition();

nameOverlay.addEventListener('mousedown', function(e) {
    e.stopPropagation();
    isDraggingName = true;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

jobOverlay.addEventListener('mousedown', function(e) {
    e.stopPropagation();
    isDraggingJob = true;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

companyOverlay.addEventListener('mousedown', function(e) {
    e.stopPropagation();
    isDraggingCompany = true;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

document.addEventListener('mousemove', function(e) {
    const rect = badgeContainer.getBoundingClientRect();
    const deltaX = e.clientX - lastMouseX;
    const deltaY = e.clientY - lastMouseY;
    const percentX = (deltaX / rect.width) * 100;
    const percentY = (deltaY / rect.height) * 100;

    if (isDraggingName) {
        const currentTop = parseFloat(nameTopInput.value);
        const currentRight = parseFloat(nameRightInput.value);
        nameTopInput.value = (currentTop + percentY).toFixed(1);
        nameRightInput.value = (currentRight - percentX).toFixed(1);
        updateNamePosition();
    } else if (isDraggingJob) {
        const currentTop = parseFloat(jobTopInput.value);
        const currentRight = parseFloat(jobRightInput.value);
        jobTopInput.value = (currentTop + percentY).toFixed(1);
        jobRightInput.value = (currentRight - percentX).toFixed(1);
        updateJobPosition();
    } else if (isDraggingCompany) {
        const currentTop = parseFloat(companyTopInput.value);
        const currentRight = parseFloat(companyRightInput.value);
        companyTopInput.value = (currentTop + percentY).toFixed(1);
        companyRightInput.value = (currentRight - percentX).toFixed(1);
        updateCompanyPosition();
    }
    
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
});

document.addEventListener('mouseup', () => {
    isDraggingName = false;
    isDraggingJob = false;
    isDraggingCompany = false;
});

copyDimensionsBtn.addEventListener('click', function() {
    const dimensions = `
NAME:
Top: ${nameTopInput.value}%
Right: ${nameRightInput.value}%
Width: ${nameWidthInput.value}%
Font: ${nameFontSizeInput.value}px

JOB TITLE:
Top: ${jobTopInput.value}%
Right: ${jobRightInput.value}%
Width: ${jobWidthInput.value}%
Font: ${jobFontSizeInput.value}px

COMPANY:
Top: ${companyTopInput.value}%
Right: ${companyRightInput.value}%
Width: ${companyWidthInput.value}%
Font: ${companyFontSizeInput.value}px
    `.trim();
    
    navigator.clipboard.writeText(dimensions).then(() => {
        const originalText = this.innerHTML;
        this.innerHTML = '‚úÖ Copied!';
        setTimeout(() => {
            this.innerHTML = originalText;
        }, 2000);
    });
});

uploadInput.addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const img = new Image();
    img.onload = function() {
        uploadedImage = img;
        imageScale = 1;
        imageX = 0;
        imageY = 0;
        zoomSlider.value = 100;
        
        drawImage();
        placeholder.style.display = 'none';
        controlsDiv.classList.add('active');
        actionButtons.classList.add('active');
    };
    img.src = URL.createObjectURL(file);
});

zoomSlider.addEventListener("input", function() {
    imageScale = this.value / 100;
    zoomValue.textContent = this.value + '%';
    drawImage();
});

canvas.addEventListener('mousedown', function(e) {
    if (!uploadedImage) return;
    isDragging = true;
    const rect = canvas.getBoundingClientRect();
    lastMouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
    lastMouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
});

canvas.addEventListener('mousemove', function(e) {
    if (!isDragging || !uploadedImage) return;
    
    const rect = canvas.getBoundingClientRect();
    const mouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
    const mouseY = (e.clientY - rect.top) * (canvas.height / rect.height);
    
    imageX += mouseX - lastMouseX;
    imageY += mouseY - lastMouseY;
    
    lastMouseX = mouseX;
    lastMouseY = mouseY;
    
    drawImage();
});

canvas.addEventListener('mouseup', () => isDragging = false);
canvas.addEventListener('mouseleave', () => isDragging = false);

canvas.addEventListener('touchstart', function(e) {
    if (!uploadedImage) return;
    e.preventDefault();
    isDragging = true;
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    lastMouseX = (touch.clientX - rect.left) * (canvas.width / rect.width);
    lastMouseY = (touch.clientY - rect.top) * (canvas.height / rect.height);
});

canvas.addEventListener('touchmove', function(e) {
    if (!isDragging || !uploadedImage) return;
    e.preventDefault();
    
    const touch = e.touches[0];
    const rect = canvas.getBoundingClientRect();
    const touchX = (touch.clientX - rect.left) * (canvas.width / rect.width);
    const touchY = (touch.clientY - rect.top) * (canvas.height / rect.height);
    
    imageX += touchX - lastMouseX;
    imageY += touchY - lastMouseY;
    
    lastMouseX = touchX;
    lastMouseY = touchY;
    
    drawImage();
});

canvas.addEventListener('touchend', () => isDragging = false);

function drawImage() {
    if (!uploadedImage) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    
    ctx.beginPath();
    ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2, 0, Math.PI * 2);
    ctx.closePath();
    ctx.clip();

    const imgWidth = uploadedImage.width;
    const imgHeight = uploadedImage.height;
    const canvasSize = canvas.width;
    
    let drawWidth, drawHeight;
    
    if (imgWidth > imgHeight) {
        drawHeight = canvasSize * imageScale;
        drawWidth = (imgWidth / imgHeight) * drawHeight;
    } else {
        drawWidth = canvasSize * imageScale;
        drawHeight = (imgHeight / imgWidth) * drawWidth;
    }
    
    const offsetX = (canvasSize - drawWidth) / 2 + imageX;
    const offsetY = (canvasSize - drawHeight) / 2 + imageY;

    ctx.drawImage(uploadedImage, 0, 0, imgWidth, imgHeight, offsetX, offsetY, drawWidth, drawHeight);
    ctx.restore();
}

linkedinBtn.addEventListener("click", function(e) {
    e.preventDefault();
    
    if (!uploadedImage) {
        alert('Please upload a photo first!');
        return;
    }

    // Better mobile detection
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    
    if (isMobile) {
        // For mobile: Try to open LinkedIn app first with a simple share intent
        const text = encodeURIComponent('Excited to share my EduHack-AI-4 badge! üéâ #EduHackAI4 #SahabaClub');
        
        // Try deep link first
        const deepLink = `linkedin://sharing/share-offsite/?url=https://www.linkedin.com`;
        window.location.href = deepLink;
        
        // Fallback to web version after a short delay
        setTimeout(() => {
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=https://www.linkedin.com&summary=${text}`, '_blank');
        }, 500);
    } else {
        // For desktop: Open LinkedIn share dialog
        window.open('https://www.linkedin.com/feed/?shareActive=true', '_blank');
    }
    
    alert('üì∏ Please download your badge first, then upload it when sharing on LinkedIn!');
});

downloadBtn.addEventListener("click", function() {
    if (!uploadedImage) {
        alert('Please upload a photo first!');
        return;
    }

    const frameImg = new Image();
    frameImg.crossOrigin = "anonymous";
    
    frameImg.onload = function() {
        const finalCanvas = document.createElement('canvas');
        finalCanvas.width = 1280;
        finalCanvas.height = 760;
        const finalCtx = finalCanvas.getContext('2d');

        finalCtx.drawImage(frameImg, 0, 0, 1280, 760);

        finalCtx.save();
        
        const circleX = 640;
        const circleY = 380;
        const circleRadius = 230;
        
        finalCtx.beginPath();
        finalCtx.arc(circleX, circleY, circleRadius, 0, Math.PI * 2);
        finalCtx.closePath();
        finalCtx.clip();

        const scale = (circleRadius * 2) / 400;
        const imgW = uploadedImage.width;
        const imgH = uploadedImage.height;
        
        let drawWidth, drawHeight;
        if (imgW > imgH) {
            drawHeight = 400 * imageScale * scale;
            drawWidth = (imgW / imgH) * drawHeight;
        } else {
            drawWidth = 400 * imageScale * scale;
            drawHeight = (imgH / imgW) * drawWidth;
        }
        
        const offsetX = circleX - drawWidth/2 + (imageX * scale);
        const offsetY = circleY - drawHeight/2 + (imageY * scale);

        finalCtx.drawImage(uploadedImage, 0, 0, imgW, imgH, offsetX, offsetY, drawWidth, drawHeight);
        finalCtx.restore();

        finalCtx.fillStyle = 'white';
        finalCtx.shadowColor = 'rgba(0, 0, 0, 0.9)';
        finalCtx.shadowBlur = 6;
        finalCtx.shadowOffsetX = 2;
        finalCtx.shadowOffsetY = 2;
        finalCtx.textAlign = 'left';
        
        const nameTopPercent = parseFloat(nameTopInput.value);
        const nameRightPercent = parseFloat(nameRightInput.value);
        const nameWidthPercent = parseFloat(nameWidthInput.value);
        const nameFont = parseInt(nameFontSizeInput.value);
        
        const nameX = 1280 - (1280 * (nameRightPercent / 100)) - (1280 * (nameWidthPercent / 100));
        const nameY = 760 * (nameTopPercent / 100);
        const nameMaxWidth = 1280 * (nameWidthPercent / 100);
        
        finalCtx.font = `bold ${nameFont}px Arial`;
        const nameText = fullNameInput.value.trim() || 'Your Name';
        wrapTextLeft(finalCtx, nameText, nameX, nameY, nameMaxWidth, nameFont * 1.2, 2);

        const jobTopPercent = parseFloat(jobTopInput.value);
        const jobRightPercent = parseFloat(jobRightInput.value);
        const jobWidthPercent = parseFloat(jobWidthInput.value);
        const jobFont = parseInt(jobFontSizeInput.value);
        
        const jobX = 1280 - (1280 * (jobRightPercent / 100)) - (1280 * (jobWidthPercent / 100));
        const jobY = 760 * (jobTopPercent / 100);
        const jobMaxWidth = 1280 * (jobWidthPercent / 100);
        
        finalCtx.font = `bold ${jobFont}px Arial`;
        const jobText = jobTitleInput.value.trim() || 'Student/Working';
        wrapTextLeft(finalCtx, jobText, jobX, jobY, jobMaxWidth, jobFont * 1.2, 2);

        const companyTopPercent = parseFloat(companyTopInput.value);
        const companyRightPercent = parseFloat(companyRightInput.value);
        const companyWidthPercent = parseFloat(companyWidthInput.value);
        const companyFont = parseInt(companyFontSizeInput.value);
        
        const companyX = 1280 - (1280 * (companyRightPercent / 100)) - (1280 * (companyWidthPercent / 100));
        const companyY = 760 * (companyTopPercent / 100);
        const companyMaxWidth = 1280 * (companyWidthPercent / 100);
        
        finalCtx.font = `bold ${companyFont}px Arial`;
        const companyText = companyInput.value.trim() || 'Your Institution';
        wrapTextLeft(finalCtx, companyText, companyX, companyY, companyMaxWidth, companyFont * 1.2, 2);

        downloadedImageUrl = finalCanvas.toDataURL("image/png");
        
        const link = document.createElement("a");
        link.download = "eduhack-ai-4-badge.png";
        link.href = downloadedImageUrl;
        link.click();
    };
    
    frameImg.onerror = function() {
        alert('Error loading frame.jpg. Make sure the file is in the same folder.');
    };
    
    frameImg.src = 'frame.jpg';
});

function wrapTextLeft(ctx, text, x, y, maxWidth, lineHeight, maxLines) {
    const words = text.split(' ');
    let lines = [];
    let currentLine = '';
    
    for (let i = 0; i < words.length; i++) {
        const testLine = currentLine + (currentLine ? ' ' : '') + words[i];
        const metrics = ctx.measureText(testLine);
        
        if (metrics.width > maxWidth && currentLine !== '') {
            lines.push(currentLine);
            currentLine = words[i];
            
            if (lines.length >= maxLines - 1) {
                const remaining = words.slice(i + 1);
                if (remaining.length > 0) {
                    currentLine += ' ' + remaining.join(' ');
                    if (ctx.measureText(currentLine).width > maxWidth) {
                        currentLine = currentLine.substring(0, currentLine.length - 3) + '...';
                    }
                }
                lines.push(currentLine);
                break;
            }
        } else {
            currentLine = testLine;
        }
    }
    
    if (lines.length < maxLines && currentLine) {
        lines.push(currentLine);
    }
    
    for (let i = 0; i < lines.length; i++) {
        ctx.fillText(lines[i], x, y + (i * lineHeight));
    }
}
</script>

</body>
</html>
